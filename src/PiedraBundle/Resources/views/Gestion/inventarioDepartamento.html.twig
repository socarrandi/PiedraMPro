{% extends '::base.html.twig' %}

{% block title %}Adicionar Pc{% endblock %}

{% block stylesheets %}
    <!-- BEGIN PAGE LEVEL STYLES -->
   
    <!-- END PAGE LEVEL STYLES -->
{% endblock %}



{% block body %}

  {% include 'PiedraBundle:include:header.html.twig' %}

  <!-- END HEADER -->
  <div class="clearfix"></div>
  <!-- BEGIN CONTAINER -->
  <div class="page-container">
    

  {% include 'PiedraBundle:include:sidebar.html.twig' %}



  <div class="page-content-wrapper">
    <div class="page-content">
      

      <!-- BEGIN PAGE CONTENT-->
      	 {% for inventario in pcs_inventarios %}
      <div class="row">
        <div class="col-md-12">
          <!-- BEGIN EXAMPLE TABLE PORTLET-->
          <div class="portlet box blue">
            <div class="portlet-title">
              <div class="caption">
                Inventario | PC: {{inventario.pc.nombrePc}} | Departamento: {{ inventario.pc.nombre}}
              </div>
              <div class="tools">
								<a class="expand" href="javascript:;" data-original-title="" title="">
								</a>
								
								<a class="remove" href="javascript:;" data-original-title="" title="">
								</a>
							</div>
              
            </div>
            <div class="portlet-body" >
              
             
              <div class="scroller"  style="height: 350px;">
              <table id="table_{{inventario.pc.id}}" class="table table-striped table-hover table-bordered dataTable" >
                  <thead>
                  <tr>
                      <th> No. </th>
                      <th> AREA</th>
                      <th> COMPONENTE</th>
                      <th> MARCA</th>
                      <th> MODELO</th>
                      <th> SERIAL</th>
                      <th> ESTADO</th>
                      <th> MEDIO BÁSICO </th>
                      <th> NO. SUBMAYOR </th>
                  </tr>
                  </thead>
                  <tbody>
                      
                      {% for inventario in inventario.inventario %}

                        <tr data-id="{{ inventario.id }}">
                            <td> {{ inventario.id }}</td>
                            <td> {{ inventario.departamento}} </td>
                            <td> {{ inventario.componente }}</td>
                            <td> {{ inventario.marca }}</td>
                            <td> {{ inventario.modelo }}</td>
                            <td> {{ inventario.serial }}</td>
                            <td> {{ inventario.estado }}</td>
                            <td> {{ inventario.medioBasico }}</td>
                            <td> {{ inventario.noSubmayor }}</td>                           
                           
                        </tr>

                      {%endfor%}

                  </tbody>
              </table>  
              </div>
            </div>
          </div>
          <!-- END EXAMPLE TABLE PORTLET-->
        </div>
      </div>

      {% endfor %}
      <!-- END PAGE CONTENT -->


      <div class="row">


      	<!-- BEGIN  MODAL Adicionar Departamento-->
      <div class="modal fade" id="modalDepartamento" tabindex="-1" role="dialog" aria-labelledby="modalDepartamento" aria-hidden="true">
        <div class="modal-dialog">

        <form role="form" action="{{path('adicionar_pc')}}" method="post" accept-charset="utf-8">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>
              <h4 class="modal-title">Adicionar Pc</h4>
            </div>
            <div class="modal-body">
               
                <div class="form-body">

                  <input type="text" name="action" value="departamento" hidden="hidden">
                  <input type="text" name="idD" value="{{ departamento.id }}" hidden="hidden">

                  <div class="form-group form-md-line-input">
                    <select class="form-control" id="departamento" name="departamento"> 
                            <option value="{{ departamento.id }}"> {{ departamento.nombre }}</option>
                        
                    </select>
                     
                    <span class="help-block">Seleccione Departamento</span>
                  </div>


                  <div class="form-group form-md-line-input">
                    <input type="text" class="form-control" id="nombre_pc" name="nombre_pc" placeholder="pc">
                    
                    <span class="help-block">Escribe el Nombre de la PC...</span>
                  </div>

                  <div class="form-group form-md-line-input">
                    <input type="text" class="form-control ipv4 " id="ip" name="ip" placeholder="ip">
                    
                    <span class="help-block">Escribe el IP...</span>
                  </div>

                  <div class="form-group form-md-line-input">
                    <input type="text" class="form-control ipv4" id="mascara" name="mascara" placeholder="mascara">
                    
                    <span class="help-block">Escribe la Mascara...</span>
                  </div>

                  <div class="form-group form-md-line-input">
                    <input type="text" class="form-control ipv4" id="puerta_enlace" name="puerta_enlace" placeholder="puerta enlace">
                    
                    <span class="help-block">Escribe la Puerta Enlace...</span>
                  </div>




                  </div>
                  </br>
               
            </div>
            <div class="modal-footer">
              <button type="submit" class="btn blue">Adicionar</button>
              <button type="button" class="btn default" data-dismiss="modal">Cancelar</button>
            </div>
          </div>

          </form>
          <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
      </div>
      <!-- /.modal -->


        <div class="col-md-12">
          <!-- BEGIN EXAMPLE TABLE PORTLET-->
          <div class="portlet box blue">
            <div class="portlet-title">
              <div class="caption">
                Inventario | Departamento: {{ departamento.nombre }}
              </div>
              <div class="tools">
								<a class="expand" href="javascript:;" data-original-title="" title="">
								</a>
								
								<a class="remove" href="javascript:;" data-original-title="" title="">
								</a>
							</div>
              
            </div>
            <div class="portlet-body" >
              <div class="table-toolbar">
                <div class="row">
                  <div class="col-md-6">
                    <div class="btn-group">
                      <a href="{{path('adicionar_inventario_null',{'idD':departamento.id})}}" data-toggle="modal" class="btn green">
                      Adicionar Inventario New <i class="fa fa-plus"></i>
                      </a>

                      <a href="#modalDepartamento" data-toggle="modal" class="btn green">
                      Adicionar Pc <i class="fa fa-plus"></i>
                      </a>


                    </div>

                  </div>
                  
                </div>
              </div>
             

              <table id="table_inventario_null" class="table table-striped table-hover table-bordered dataTable" >
                  <thead>
                  <tr>
                      <th> No. </th>
                      <th> AREA</th>
                      <th> PC </th>
                      <th> COMPONENTE</th>
                      <th> MARCA</th>
                      <th> MODELO</th>
                      <th> SERIAL</th>
                      <th> ESTADO</th>
                      <th> MEDIO BÁSICO </th>
                      <th> NO. SUBMAYOR </th>
                  </tr>
                  </thead>
                  <tbody>
                      
                      {% for inventario in inventario_nullpc %}

                        <tr data-id="{{ inventario.id }}">
                            <td> {{ inventario.id }}</td>
                            <td> {{ inventario.departamento}} </td>
                            <td> {{ inventario.pc }}</td>
                            <td> {{ inventario.componente }}</td>
                            <td> {{ inventario.marca }}</td>
                            <td> {{ inventario.modelo }}</td>
                            <td> {{ inventario.serial }}</td>
                            <td> {{ inventario.estado }}</td>
                            <td> {{ inventario.medioBasico }}</td>
                            <td> {{ inventario.noSubmayor }}</td>                           
                           
                        </tr>

                      {%endfor%}

                  </tbody>
              </table>  

            </div>
          </div>
          <!-- END EXAMPLE TABLE PORTLET-->
        </div>
      </div>


    </div>
  </div>

  </div>



{% endblock %}

{% block javascripts %}

    <!-- BEGIN PAGE LEVEL PLUGINS -->
    
    <script  src="{{asset('bundles/piedra/global/plugins/jquery-tabledit/jquery.tabledit.js')}}"></script>
    <script  src="{{asset('bundles/piedra/global/plugins/jquery.input-ip-address-control-1.0.min.js')}}"></script>


  

    <script type="text/javascript">   	

      $('.ipv4').ipAddress(); 

      $(document).ready(function(){

        var pcs;
        var componentes;        

        $.ajax({
          type: 'POST',
          url: '{{ path('lista_pc_ajax')}}',
          data: {
            'idD': {{departamento.id}}
          }, success: function(datos){

             pcs = '{' ; var cont = 0;
             for (var i=0; i < datos['pcs'].length ; i++){

              
               cont++;
                if(cont == datos['pcs'].length){
                    pcs += '"'+datos['pcs'][i]['id']+'": "'+datos['pcs'][i]['nombrePc']+'"}';
                }else{
                    pcs += '"'+datos['pcs'][i]['id']+'": "'+datos['pcs'][i]['nombrePc']+'",';
                }
            }   

             componentes = '{' ; var cont = 0;
             for (var i=0; i < datos['componentes'].length ; i++){

              console.log(datos['componentes']);
               cont++;
                if(cont == datos['componentes'].length){
                    componentes += '"'+datos['componentes'][i]['id']+'": "'+datos['componentes'][i]['componente']+'"}';
                }else{
                    componentes += '"'+datos['componentes'][i]['id']+'": "'+datos['componentes'][i]['componente']+'",';
                }
            } 


             if (pcs == '{'){ pcs = '{"0": "seleccione pc:"}' }

              
            $('#table_inventario_null').Tabledit({
                url: '{{path('inventario_departamento',{"idD":departamento.id})}}',
                editButton: false,       
                editmethod: 'post',
                deletemethod: 'post',
                buttons: {
                    delete: {
                        class: 'btn btn-sm btn-danger',
                        html: '<span class="glyphicon glyphicon-trash"></span> &nbsp ELIMINAR',
                        action: 'delete'
                    },
                    edit: {
                    class: 'btn btn-sm btn-primary',
                    html: '<span class="glyphicon glyphicon-pencil"></span> &nbsp EDIT',
                    action: 'edit'
                    },
                    save: {
                      class: 'btn btn-sm btn-success',
                      html: 'Save'
                    },
                    restore: {
                      class: 'btn btn-sm btn-warning',
                      html: 'Restore',
                      action: 'restore'
                    },
                    confirm: {
                        class: 'btn btn-sm btn-default',
                        html: 'CONFIRMAR'
                    }
                },

                columns: {
                  identifier: [0, 'id'],                    
                  editable: [[2, 'pc', 'select',  pcs ],[3, 'componente', 'select', componentes ],[4, 'marca'], [5, 'modelo'], [6, 'serial'], [7, 'estado','select','{"OK":"OK", "ROTO":"ROTO"}'],[8, 'medio_basico'],[9, 'no_submayor']]
                },  
          });


         for (var i=0; i < datos['pcs'].length ; i++){

          var idPcs = datos['pcs'][i]['id'];

          $('#table_'+idPcs).Tabledit({
                url: '../inventario_pc/'+idPcs,
                editButton: false,       
                editmethod: 'post',
                deletemethod: 'post',
                buttons: {
                    delete: {
                        class: 'btn btn-sm btn-danger',
                        html: '<span class="glyphicon glyphicon-trash"></span> &nbsp ELIMINAR',
                        action: 'delete'
                    },
                    edit: {
                    class: 'btn btn-sm btn-primary',
                    html: '<span class="glyphicon glyphicon-pencil"></span> &nbsp EDIT',
                    action: 'edit'
                    },
                    save: {
                      class: 'btn btn-sm btn-success',
                      html: 'Save'
                    },
                    restore: {
                      class: 'btn btn-sm btn-warning',
                      html: 'Restore',
                      action: 'restore'
                    },
                    confirm: {
                        class: 'btn btn-sm btn-default',
                        html: 'CONFIRMAR'
                    }
                },

                columns: {
                  identifier: [0, 'id'],                    
                  editable: [[2, 'componente','select', componentes ],[3, 'marca'], [4, 'modelo'], [5, 'serial'], [6, 'estado','select','{"OK":"OK", "ROTO":"ROTO"}'],[7, 'medio_basico'],[8, 'no_submayor']]
        },

      });


         } 
          }
        })



      });
       
     
    </script>
    <!-- END PAGE LEVEL PLUGINS -->

 


{% endblock %}


